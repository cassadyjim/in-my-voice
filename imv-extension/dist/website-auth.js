(()=>{"use strict";const e="sb-jpfillyapcxylcogirxq-auth-token";async function n(n){try{await chrome.storage.local.set({[e]:JSON.stringify(n)}),console.log("IMV: Session synced to extension"),chrome.runtime.sendMessage({type:"SESSION_SYNCED",email:n.user?.email})}catch(e){console.error("IMV: Failed to sync session",e)}}function t(){const e=document.createElement("div");e.innerHTML='\n    <div style="\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n      padding: 16px 24px;\n      border-radius: 12px;\n      box-shadow: 0 4px 20px rgba(0,0,0,0.2);\n      z-index: 999999;\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n      font-size: 14px;\n      animation: slideIn 0.3s ease-out;\n    ">\n      <div style="display: flex; align-items: center; gap: 12px;">\n        <span style="font-size: 24px;">ðŸŽ¤</span>\n        <div>\n          <div style="font-weight: 600;">IMV Extension Connected!</div>\n          <div style="opacity: 0.9; font-size: 12px; margin-top: 2px;">Your voice profile is now synced</div>\n        </div>\n      </div>\n    </div>\n    <style>\n      @keyframes slideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n    </style>\n  ',document.body.appendChild(e),setTimeout(()=>{e.style.transition="opacity 0.3s",e.style.opacity="0",setTimeout(()=>e.remove(),300)},4e3)}!async function(){await new Promise(e=>setTimeout(e,1e3));const o=function(){try{const n=localStorage.getItem(e);return n?JSON.parse(n):null}catch{return null}}();if(o?.access_token){const s=await chrome.storage.local.get([e]),i=s[e]?JSON.parse(s[e]):null;i&&i.access_token===o.access_token||(await n(o),t())}}(),window.addEventListener("storage",o=>{if(o.key===e&&o.newValue)try{const e=JSON.parse(o.newValue);e.access_token&&(n(e),t())}catch{}})})();